<div>
  <app-loading-spinner *ngIf="!termDetails && !apiError"></app-loading-spinner>
  <app-api-error-display *ngIf="apiError" [error]="apiError"></app-api-error-display>
 
  <div id="term-details" class="details-page" *ngIf="termDetails">
    <app-contact-email class="contact-email" [linkName]="'Contact curators ...'"
                       [subject]="'Comment or problem report'"></app-contact-email>
    <div class="details-page-name-and-id">
      {{termDetails.termid}} - {{termDetails.name}}
    </div>

    <div id="term-summary" class="details-page-summary">
      <table>
        <tr>
          <td *ngIf="termDetails.definition" class="details-label">Definition</td>
          <td *ngIf="filteredAncestors.length > 0" class="details-label">Parents</td>
        </tr>
        <tr *ngFor="let parentDetails of filteredAncestors; let firstRow = first">
          <td *ngIf="firstRow" [attr.rowspan]="filteredAncestors.length + 1">{{termDetails.definition}}</td>
          <td class="term-parent-column">
            <span class="details-label term-parent-rel">{{parentDetails.relation_name}}</span>
            <a routerLink="/term/{{parentDetails.termid}}"
               routerLinkActive="active">{{parentDetails.term_name}}</a>
          </td>
        </tr>
      </table>
    </div>

    <div id="term-details-menu">
      <app-details-page-menu *ngIf="termDetails"
                             [title]="termDetails.termid"
                             [visibleSections]="visibleSections"></app-details-page-menu>
    </div>

    <div class="external-links">
      <div *ngIf="isInSubset('bp_goslim_pombe')">
        <div>
This term is part of the
<a routerLink="/browse-curation/fission-yeast-go-slim-terms" routerLinkActive="active">biological process overview</a> (GO slim).
        </div>
      <app-external-link [identifierForLink]="termDetails.termid"
                         [linkName]="'View the esyN network'"
                         [linkConfigKey]="'esyn'"
                         [iconImage]="'esyn_icon.png'">
      </app-external-link>
      </div>
    </div>

    <hr style="clear: both" />

    <div *ngIf="annotationFeatureType == 'gene'" class="term-page-view-change">
      <a routerLink="/term_genes/{{termDetails.termid}}"
         routerLinkActive="active">View genes annotated with this term ...</a>
    </div>

    <div *ngIf="annotationFeatureType == 'genotype'" class="term-page-view-change">
      <div>
        <a routerLink="/term_single_allele_genotype_genes/{{termDetails.termid}}"
           routerLinkActive="active">Genes from single-allele genotypes associated with this term ...</a>
      </div>
      <div>
        <a routerLink="/term_genotypes/{{termDetails.termid}}">Single-allele genotypes associated with this term ...</a>
      </div>
    </div>

    <div>
    <div *ngFor="let annotationTypeName of annotationTypeNames">

      <div *ngIf="termDetails.cv_annotations[annotationTypeName]">
        <app-annotation-table id="{{annotationTypeName}}"
                              *ngIf="annotationTypeName != 'qualitative_gene_expression' && annotationTypeName != 'quantitative_gene_expression'"
                              [scope]="'term'"
                              [tableDisplayName]="config.annotationTypes[annotationTypeName].display_name + ' annotations for ' + termDetails.termid + ' and its descendants'"
                              [annotationTypeName]="termDetails.cv_name"
                              [featureInFirstColumn]="true"
                              [annotationTable]="termDetails.cv_annotations[annotationTypeName]"></app-annotation-table>
      </div>
    </div>
  </div>
</div>
