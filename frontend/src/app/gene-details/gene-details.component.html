<div>
  <app-loading-spinner *ngIf="!geneDetails && !apiError"></app-loading-spinner>
  <app-api-error-display *ngIf="apiError" [error]="apiError"></app-api-error-display>
  <div id="gene-details-menu"
       [ngClass]="{'menu-pos-fixed': menuPositionFixed, 'menu-pos-absolute': !menuPositionFixed}">
    <app-gene-page-menu *ngIf="geneDetails"
                        [geneDetails]="geneDetails"
                        [visibleSections]="visibleSections"></app-gene-page-menu>
  </div>

  <div id="gene-details" *ngIf="geneDetails">
    <app-contact-email class="contact-email" [linkName]="'Contact curators ...'"
                       [subject]="'Comment or problem report for ' + displayNameLong()"></app-contact-email>
    <div class="details-page-name-and-id">
    <div class="gene-details-name-id">
    <span *ngIf="!appConfig.isConfigOrganism(geneDetails.organism.genus, geneDetails.organism.species)">
      <span class="name-id">{{geneDetails.organism.genus}} {{geneDetails.organism.species}}</span>
    </span>
    <span *ngIf="geneDetails.name">
      <span class="name-id">{{geneDetails.name}}</span>
    </span>
    <span *ngIf="!geneDetails.name">
      <span class="name-id">{{geneDetails.uniquename}}</span>
    </span>
    </div>
    </div>

    <hr style="clear: both" />

    <div id="gene-summary" class="details-page-summary">
    <table>
      <tbody>
        <tr>
          <td class="details-label">Gene standard name</td>
          <td>{{geneDetails.name || ''}}</td>
          <td class="details-label">Characterisation status</td>
          <td>{{geneDetails.characterisation_status}}</td>
        </tr>
        <tr>
          <td class="details-label">Product</td>
          <td>{{geneDetails.product}}</td>
          <td class="details-label">Feature Type</td>
          <td>{{displayFeatureType}}</td>
        </tr>
        <tr>
          <td class="details-label">Systematic ID</td>
          <td>{{geneDetails.uniquename}}</td>
          <td class="details-label">Product size</td>
          <td>{{productSize}}</td>
        </tr>
        <tr>
          <td class="details-label">Genomic location</td>
          <td>{{displayLocation}}</td>
          <td *ngIf="synonymsDisplay.length > 0" class="details-label">Synonyms</td>
          <td *ngIf="synonymsDisplay.length > 0">{{synonymsDisplay}}</td>
        </tr>
        <tr *ngIf="geneDetails.name_descriptions.length > 0 || synonymsDisplay.length > 0">
          <td class="details-label"><span *ngIf="geneDetails.name_descriptions.length > 0">Name description</span></td>
          <td>
            <span *ngFor="let nameDesc of geneDetails.name_descriptions; let i = index">
              {{nameDesc}}<span *ngIf="i < geneDetails.name_descriptions.length - 1">,<br/></span>
            </span>
          </td>
        </tr>
      </tbody>
    </table>
    </div>

    <hr style="clear: both" />
    <div class="chromosome-region-view"
         *ngIf="appConfig.isConfigOrganism(geneDetails.organism.genus, geneDetails.organism.species)">
      <div *ngIf="ensemblImageUrl">
        <a href="http://fungi.ensembl.org/Schizosaccharomyces_pombe/Location/View?db=core;g={{geneDetails.uniquename}}">
           <img src="{{ensemblImageUrl}}" />
           <div class="ensembl-link-label">View in Ensembl Genome browser ...</div>
        </a>
      </div>
    </div>


    <app-gene-neighbourhood [focusGeneUniquename]="geneDetails.uniquename"
                            [focusGeneName]="geneDetails.name"
                            [neighbourhood]="geneDetails.gene_neighbourhood"></app-gene-neighbourhood>

    <hr style="clear: both" />

    <div *ngFor="let annotationTypeName of annotationTypeNames">

      <div *ngIf="geneDetails.cv_annotations[annotationTypeName]">
        <app-qual-gene-ex-table id="{{annotationTypeName}}" *ngIf="annotationTypeName == 'qualitative_gene_expression'"
                                 [annotationTable]="geneDetails.cv_annotations[annotationTypeName]"></app-qual-gene-ex-table>

        <app-quant-gene-ex-table id="{{annotationTypeName}}" *ngIf="annotationTypeName == 'quantitative_gene_expression'"
                                 [annotationTable]="geneDetails.cv_annotations[annotationTypeName]"></app-quant-gene-ex-table>

        <app-annotation-table id="{{annotationTypeName}}"
                              *ngIf="annotationTypeName != 'qualitative_gene_expression' && annotationTypeName != 'quantitative_gene_expression'"
                              [annotationTypeName]="annotationTypeName"
                              [geneDetails]="geneDetails"
                              [hideColumns]="['gene', 'desc-rel']"
                              [annotationTable]="geneDetails.cv_annotations[annotationTypeName]"></app-annotation-table>
      </div>

      <app-interaction-annotation-table *ngIf="annotationTypeName == 'physical_interactions'"
                                        id="{{annotationTypeName}}"
                                      [annotationTypeName]="annotationTypeName"
                                      [currentGene]="geneDetails"
                                      [annotationTable]="geneDetails.physical_interactions"></app-interaction-annotation-table>
      <app-interaction-annotation-table *ngIf="annotationTypeName == 'genetic_interactions'"
                                        id="{{annotationTypeName}}"
                                      [annotationTypeName]="annotationTypeName"
                                      [currentGene]="geneDetails"
                                      [annotationTable]="geneDetails.genetic_interactions"></app-interaction-annotation-table>

      <app-ortholog-annotation-table *ngIf="annotationTypeName == 'orthologs'"
                                     id="{{annotationTypeName}}"
                                     [currentGene]="geneDetails"
                                     [annotationTable]="geneDetails.ortholog_annotations"></app-ortholog-annotation-table>
      <app-paralog-annotation-table *ngIf="annotationTypeName == 'paralogs'"
                                    id="{{annotationTypeName}}"
                                    [annotationTable]="geneDetails.paralog_annotations"></app-paralog-annotation-table>
      <app-target-of-annotation-table *ngIf="annotationTypeName == 'target_of'"
                                      id="{{annotationTypeName}}"
                                      [annotationTable]="geneDetails.target_of_annotations"></app-target-of-annotation-table>
    </div>

    <app-transcript-sequence-select id="transcript-sequence"
                                    [geneDetails]="geneDetails"></app-transcript-sequence-select>

    <app-gene-external-references id="external-refs"
                                  [geneDetails]="geneDetails"></app-gene-external-references>

    <app-gene-references-table id="literature"
                               [references]="geneDetails.references"></app-gene-references-table>
  </div>
</div>
