<div class="vis-main">
  <div class="vis-column-select">
    <div *ngFor="let colName of visColumnNames">
      {{visColumnConfigs[colName].display_name}}:
      <input type="checkbox"
             (change)="confSelectionChanged()"
             [(ngModel)]="selectedColumns[colName]"/>
      <a *ngIf="showResults()" (click)="setSortBy(colName)">[sort]</a>
    </div>
    <div *ngIf="showResults()">
      <a (click)="setSortBy('gene-name')">[Sort by gene name]</a>
    </div>

    <div class="feature-size">
      Feature size: <a *ngIf="lineHeight > 1" (click)="changeLineHeight(-1)">[-]</a>
      <a (click)="changeLineHeight(1)">[+]</a>
    </div>
  </div>

  <div class="vis-results">
    <div *ngIf="!showResults()">
      (Select a column type from the list to the left)
    </div>

    <div *ngIf="showResults()">
      <div class="vis-svg">
        <svg [attr.width]="geneWidth + selectedConfigNames.length * (columnWidth + columnGap) + 20"
             [attr.height]="genes.length * lineHeight + 10"
             xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"
             id="gene-vis" overflow="visible">
          <g style="pointer-events: all">
            <rect *ngFor="let geneData of getGeneDisplayData()"
                  (mouseenter)="mouseenter($event)" (mouseleave)="mouseleave($event)"
                  class="vis-gene" [attr.id]="geneData.id" [attr.height]="lineHeight"
                  [attr.width]="geneWidth + (selectedConfigNames.length * this.columnWidth + columnGap)"
                  [attr.x]="0"
                  [attr.y]="geneData.geneIndex * lineHeight"
                  stroke-width="0" stroke="#9f9"
                  [attr.fill]="geneData.color"
                  style="pointer-events:inherit">
            </rect>
          </g>
          <g *ngFor="let columnName of selectedConfigNames; let columnIndex = index"
             style="pointer-events: none">
            <rect *ngFor="let columnData of getColumnDisplayDataMap()[columnName]"
                  (mouseenter)="mouseenter($event)" (mouseleave)="mouseleave($event)"
                  class="vis-column"
                  [attr.height]="lineHeight * (columnData.endIndex - columnData.startIndex + 1)"
                  [attr.width]="columnWidth"
                  [attr.x]="this.geneWidth + columnIndex * (this.columnWidth + this.columnGap) + columnGap"
                  [attr.y]="lineHeight * columnData.startIndex"
                  stroke-width="0" stroke="#9f9"
                  [attr.fill]="columnData.color" fill-opacity="0.6"
                  style="pointer-events:inherit">
            </rect>
          </g>
        </svg>
      </div>
    </div>
  </div>

  <div class="vis-gene-details" *ngIf="currentGene">
    <div>
      {{currentGene.getGeneShort().name}} {{currentGene.getGeneShort().uniquename}}
    </div>
    <div *ngFor="let colName of visColumnNames">
      {{visColumnConfigs[colName].display_name}}: {{currentGene.getField(colName)}}
    </div>
  </div>
</div>
